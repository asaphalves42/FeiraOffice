  CREATE DATABASE FeiraOffice;
  GO


  USE FeiraOffice;
  GO


  CREATE TABLE Tipo_Utilizador (
    Id INT PRIMARY KEY IDENTITY,
    Nome VARCHAR(100)
  );


  CREATE TABLE Utilizador (
    Id INT PRIMARY KEY IDENTITY,
    Username VARCHAR(30),
    Password VARCHAR(300),
    Id_Role INT,
    FOREIGN KEY (Id_Role) REFERENCES Tipo_Utilizador (Id)
  );


  CREATE TABLE Taxa_Pais (
    Id INT PRIMARY KEY,
    Sigla VARCHAR(100),
    Valor FLOAT
  );


  CREATE TABLE Quantidade (
    Id_Interno INT PRIMARY KEY IDENTITY,
    Descricao VARCHAR(255)
  );


  CREATE TABLE Unidade (
    Id INT PRIMARY KEY IDENTITY,
    Tipo_Unidade VARCHAR(100)
  );


  CREATE TABLE Fornecedor (
    Id INT PRIMARY KEY IDENTITY,
    Id_Utilizador INT,
    Nome VARCHAR(100),
    Morada VARCHAR(100),
    NIF INT,
    Telefone INT,
    FOREIGN KEY (Id_Utilizador) REFERENCES Utilizador (Id)
  );


  CREATE TABLE Status (
    Id INT PRIMARY KEY IDENTITY,
    Descricao VARCHAR(100)
  );


  CREATE TABLE Produto (
    Id INT PRIMARY KEY IDENTITY,
    Id_Fornecedor INT,
    Descricao VARCHAR(100),
    Id_Quantidade INT,
    FOREIGN KEY (Id_Fornecedor) REFERENCES Fornecedor (Id),
    FOREIGN KEY (Id_Quantidade) REFERENCES Quantidade (Id_Interno)
  );


  CREATE TABLE Encomenda (
    Id INT PRIMARY KEY IDENTITY,
    Id_Fornecedor INT,
    Data_Encomenda DATETIME,
    FOREIGN KEY (Id_Fornecedor) REFERENCES Fornecedor (Id)
  );


  CREATE TABLE Entrada_Stock (
    Id INT PRIMARY KEY IDENTITY,
    Id_Fornecedor INT,
    Id_Utilizador INT,
    Id_Produto INT,
    Quantidade FLOAT,
    Data_Entrada DATETIME,
    Data_Saida DATETIME,
    Id_Status INT,
    FOREIGN KEY (Id_Fornecedor) REFERENCES Fornecedor (Id),
    FOREIGN KEY (Id_Utilizador) REFERENCES Utilizador (Id),
    FOREIGN KEY (Id_Produto) REFERENCES Produto (Id),
    FOREIGN KEY (Id_Status) REFERENCES Status (Id)
  );

  CREATE TABLE Tipo_Moeda (
    Id INT PRIMARY KEY IDENTITY,
    Nome VARCHAR(100), 
    Cambio FLOAT
  );

  CREATE TABLE Produto_Encomenda (
    Id_Encomenda INT,
    Id_Interno INT,
    Id_Externo INT,
    Data_Entrada DATETIME,
    Id_Quantidade INT,
    Id_Unidade INT,
    Id_Pais INT,
    Valor_Sem_Taxa FLOAT,
    Valor_Com_Taxa FLOAT,
    Id_Moeda INT,
    FOREIGN KEY (Id_Encomenda) REFERENCES Encomenda (Id),
    FOREIGN KEY (Id_Interno) REFERENCES Produto (Id),
    FOREIGN KEY (Id_Unidade) REFERENCES Unidade (Id),
    FOREIGN KEY (Id_Quantidade) REFERENCES Quantidade (Id_Interno),
    FOREIGN KEY (Id_Pais) REFERENCES Taxa_Pais (Id),
    FOREIGN KEY (Id_Moeda) REFERENCES Tipo_Moeda (id)
  );


  CREATE TABLE ContaCorrente (
    Id INT PRIMARY KEY IDENTITY,
    Data_Transacao DATETIME,
    Saldo FLOAT,
    Id_Entrada_Stock INT,
    Id_Fornecedor INT,
    FOREIGN KEY (Id_Entrada_Stock) REFERENCES Entrada_Stock (Id),
    FOREIGN KEY (Id_Fornecedor) REFERENCES Fornecedor (Id)
  );


  CREATE TABLE Pagamento (
    Id INT PRIMARY KEY IDENTITY,
    Valor FLOAT,
    Data_Transacao DATETIME
  );


  CREATE TABLE Pagamento_ContaCorrente (
    Id_Pagamento INT PRIMARY KEY IDENTITY,
    Id_ContaCorrente INT
  );



